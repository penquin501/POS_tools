!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).VueZoomer=e()}(this,(function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e="Expected a function",i=NaN,n="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,r=/^0o[0-7]+$/i,l=parseInt,h="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=h||c||Function("return this")(),d=Object.prototype.toString,m=Math.max,f=Math.min,p=function(){return u.Date.now()};function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&d.call(t)==n}(t))return i;if(v(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var h=a.test(t);return h||r.test(t)?l(t.slice(2),h?2:8):s.test(t)?i:+t}function y(){let t=[],e=[];function i(t,e){t.forEach(t=>{t.call(null,e)})}this.onSingleTap=function(e){"function"!=typeof e||t.includes(e)||t.push(e)},this.onDoubleTap=function(t){"function"!=typeof t||e.includes(t)||e.push(t)},this.attach=function(t){t instanceof Element?(t.addEventListener("touchstart",h),t.addEventListener("touchmove",u),t.addEventListener("touchend",c),t.addEventListener("mousedown",d),t.addEventListener("mouseup",m),t.addEventListener("mousemove",f)):console.error("TapDetector.attach: arg must be an Element")},this.detach=function(t){t.removeEventListener("touchstart",h),t.removeEventListener("touchmove",u),t.removeEventListener("touchend",c),t.removeEventListener("mousedown",d),t.removeEventListener("mouseup",m),t.removeEventListener("mousemove",f)};let n=!1,o=0,s=0,a=0,r=0,l=0;function h(t){n=!0,1===t.touches.length&&p(t.touches[0].clientX,t.touches[0].clientY)}function c(t){0===t.touches.length&&v()}function u(t){1===t.touches.length&&g(t.touches[0].clientX,t.touches[0].clientY)}function d(t){n||p(t.clientX,t.clientY)}function m(t){n||v()}function f(t){n||0===t.button&&g(t.clientX,t.clientY)}function p(t,e){r=t,l=e,a=0}function v(){let n=Date.now();a<10&&(n-o<300?s+=1:s=1,o=Date.now(),i(t,{clientX:r,clientY:l}),2===s&&(i(e,{clientX:r,clientY:l}),s=0)),a=0}function g(t,e){let i=r-t,n=l-e,o=Math.sqrt(i*i+n*n);a+=o,r=t,l=e}}var w={props:{minScale:{type:Number,default:1},maxScale:{type:Number,default:5},zoomed:{type:Boolean,default:!1},resetTrigger:{type:Number,default:1e5},aspectRatio:{type:Number,default:1},backgroundColor:{type:String,default:"transparent"},pivot:{type:String,default:"cursor"},limitTranslation:{type:Boolean,default:!0},doubleClickToZoom:{type:Boolean,default:!0}},data:()=>({containerWidth:1,containerHeight:1,containerLeft:0,containerTop:0,translateX:0,animTranslateX:0,translateY:0,animTranslateY:0,scale:1,animScale:1,lastFullWheelTime:0,lastWheelTime:0,lastWheelDirection:"y",isPointerDown:!1,pointerPosX:-1,pointerPosY:-1,twoFingerInitDist:0,panLocked:!0,raf:null,tapDetector:null}),computed:{wrapperStyle(){return{transform:[`translate(${this.containerWidth*this.animTranslateX}px, ${this.containerHeight*this.animTranslateY}px)`,`scale(${this.animScale})`].join(" ")}}},watch:{scale(t){1!==t&&(this.$emit("update:zoomed",!0),this.panLocked=!1)},resetTrigger:"reset"},mounted(){this.tapDetector=new y,this.tapDetector.attach(this.$el),this.doubleClickToZoom&&this.tapDetector.onDoubleTap(this.onDoubleTap),window.addEventListener("resize",this.onWindowResize),this.onWindowResize(),this.refreshContainerPos(),this.loop()},destroyed(){this.tapDetector.detach(this.$el),window.removeEventListener("resize",this.onWindowResize),window.cancelAnimationFrame(this.raf)},methods:{reset(){this.scale=1,this.panLocked=!0,this.translateX=0,this.translateY=0},zoomIn(t=2){this.tryToScale(t),this.onInteractionEnd()},zoomOut(t=.5){this.tryToScale(t),this.onInteractionEnd()},tryToScale(t){let e=this.scale*t;if(e<this.minScale||e>this.maxScale){let i=Math.log2(t);i*=.2,t=Math.pow(2,i),e=this.scale*t}if(t=e/this.scale,this.scale=e,"image-center"!==this.pivot){let e=(this.pointerPosX-this.containerLeft)/this.containerWidth,i=(this.pointerPosY-this.containerTop)/this.containerHeight;this.translateX=(.5+this.translateX-e)*t+e-.5,this.translateY=(.5+this.translateY-i)*t+i-.5}},setPointerPosCenter(){this.pointerPosX=this.containerLeft+this.containerWidth/2,this.pointerPosY=this.containerTop+this.containerHeight/2},onPointerMove(t,e){if(this.isPointerDown){let i=t-this.pointerPosX,n=e-this.pointerPosY;this.panLocked||(this.translateX+=i/this.containerWidth,this.translateY+=n/this.containerHeight)}this.pointerPosX=t,this.pointerPosY=e},onInteractionEnd:function(t,i,n){var o,s,a,r,l,h,c=0,u=!1,d=!1,y=!0;if("function"!=typeof t)throw new TypeError(e);function w(e){var i=o,n=s;return o=s=void 0,c=e,r=t.apply(n,i)}function T(t){var e=t-h;return void 0===h||e>=i||e<0||d&&t-c>=a}function X(){var t=p();if(T(t))return b(t);l=setTimeout(X,function(t){var e=i-(t-h);return d?f(e,a-(t-c)):e}(t))}function b(t){return l=void 0,y&&o?w(t):(o=s=void 0,r)}function P(){var t=p(),e=T(t);if(o=arguments,s=this,h=t,e){if(void 0===l)return function(t){return c=t,l=setTimeout(X,i),u?w(t):r}(h);if(d)return l=setTimeout(X,i),w(h)}return void 0===l&&(l=setTimeout(X,i)),r}return i=g(i)||0,v(n)&&(u=!!n.leading,a=(d="maxWait"in n)?m(g(n.maxWait)||0,i):a,y="trailing"in n?!!n.trailing:y),P.cancel=function(){void 0!==l&&clearTimeout(l),c=0,o=h=s=l=void 0},P.flush=function(){return void 0===l?r:b(p())},P}((function(){this.limit(),this.panLocked=1===this.scale,this.$emit("update:zoomed",!this.panLocked)}),100),limit(){if(this.scale<this.minScale?this.scale=this.minScale:this.scale>this.maxScale&&this.tryToScale(this.maxScale/this.scale),this.limitTranslation){let t=this.calcTranslateLimit();Math.abs(this.translateX)>t.x&&(this.translateX*=t.x/Math.abs(this.translateX)),Math.abs(this.translateY)>t.y&&(this.translateY*=t.y/Math.abs(this.translateY))}},calcTranslateLimit(){if("y"===this.getMarginDirection()){let t=this.containerWidth/this.aspectRatio/this.containerHeight,e=(this.scale*t-1)/2;return e<0&&(e=0),{x:(this.scale-1)/2,y:e}}{let t=this.containerHeight*this.aspectRatio/this.containerWidth,e=(this.scale*t-1)/2;return e<0&&(e=0),{x:e,y:(this.scale-1)/2}}},getMarginDirection(){return this.containerWidth/this.containerHeight>this.aspectRatio?"x":"y"},onDoubleTap(t){1===this.scale?(t.clientX>0&&(this.pointerPosX=t.clientX,this.pointerPosY=t.clientY),this.tryToScale(Math.min(3,this.maxScale))):this.reset(),this.onInteractionEnd()},onWindowResize(){let t=window.getComputedStyle(this.$el);this.containerWidth=parseFloat(t.width),this.containerHeight=parseFloat(t.height),this.setPointerPosCenter(),this.limit()},refreshContainerPos(){let t=this.$el.getBoundingClientRect();this.containerLeft=t.left,this.containerTop=t.top},loop(){this.animScale=this.gainOn(this.animScale,this.scale),this.animTranslateX=this.gainOn(this.animTranslateX,this.translateX),this.animTranslateY=this.gainOn(this.animTranslateY,this.translateY),this.raf=window.requestAnimationFrame(this.loop)},gainOn(t,e){let i=.3*(e-t);return Math.abs(i)>1e-5?t+i:e},onMouseWheel(t){t.detail&&(t.wheelDelta=-10*t.detail);let e=Date.now();120===Math.abs(t.wheelDelta)?e-this.lastFullWheelTime>50&&(this.onMouseWheelDo(t.wheelDelta),this.lastFullWheelTime=e):(e-this.lastWheelTime>50&&"number"==typeof t.deltaX&&(this.lastWheelDirection=0==t.detail&&Math.abs(t.deltaX)>Math.abs(t.deltaY)?"x":"y","x"===this.lastWheelDirection&&this.$emit("swipe",t.deltaX>0?"left":"right")),"y"===this.lastWheelDirection&&this.onMouseWheelDo(t.wheelDelta)),this.lastWheelTime=e},onMouseWheelDo(t){let e=Math.pow(1.25,t/120);this.tryToScale(e),this.onInteractionEnd()},onMouseDown(t){this.refreshContainerPos(),this.isPointerDown=!0,this.pointerPosX=t.clientX,this.pointerPosY=t.clientY},onMouseUp(t){this.isPointerDown=!1,this.onInteractionEnd()},onMouseMove(t){this.onPointerMove(t.clientX,t.clientY)},onTouchStart(t){if(1===t.touches.length)this.refreshContainerPos(),this.pointerPosX=t.touches[0].clientX,this.pointerPosY=t.touches[0].clientY,this.isPointerDown=!0;else if(2===t.touches.length){this.isPointerDown=!0,this.pointerPosX=(t.touches[0].clientX+t.touches[1].clientX)/2,this.pointerPosY=(t.touches[0].clientY+t.touches[1].clientY)/2;let e=t.touches[0].clientX-t.touches[1].clientX,i=t.touches[0].clientY-t.touches[1].clientY;this.twoFingerInitDist=Math.sqrt(e*e+i*i)}},onTouchEnd(t){0===t.touches.length?(this.isPointerDown=!1,Math.abs(this.scale-1)<.1&&(this.scale=1),this.onInteractionEnd()):1===t.touches.length&&(this.pointerPosX=t.touches[0].clientX,this.pointerPosY=t.touches[0].clientY)},onTouchMove(t){if(1===t.touches.length)this.onPointerMove(t.touches[0].clientX,t.touches[0].clientY);else if(2===t.touches.length){let e=(t.touches[0].clientX+t.touches[1].clientX)/2,i=(t.touches[0].clientY+t.touches[1].clientY)/2;this.onPointerMove(e,i),this.pointerPosX=e,this.pointerPosY=i;let n=t.touches[0].clientX-t.touches[1].clientX,o=t.touches[0].clientY-t.touches[1].clientY,s=Math.sqrt(n*n+o*o);this.tryToScale(s/this.twoFingerInitDist),this.twoFingerInitDist=s}}}};var T,X=function(t,e,i,n,o,s,a,r,l,h){"boolean"!=typeof a&&(l=r,r=a,a=!1);var c,u="function"==typeof i?i.options:i;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),n&&(u._scopeId=n),s?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=c):e&&(c=a?function(){e.call(this,h(this.$root.$options.shadowRoot))}:function(t){e.call(this,r(t))}),c)if(u.functional){var d=u.render;u.render=function(t,e){return c.call(e),d(t,e)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,c):[c]}return i},b="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var P={};var S=function(t){return function(t,e){return function(t,e){var i=b?e.media||"default":t,n=P[i]||(P[i]={ids:new Set,styles:[]});if(!n.ids.has(t)){n.ids.add(t);var o=e.source;if(e.map&&(o+="\n/*# sourceURL="+e.map.sources[0]+" */",o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",e.media&&n.element.setAttribute("media",e.media),void 0===T&&(T=document.head||document.getElementsByTagName("head")[0]),T.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(o),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{var s=n.ids.size-1,a=document.createTextNode(o),r=n.element.childNodes;r[s]&&n.element.removeChild(r[s]),r.length?n.element.insertBefore(a,r[s]):n.element.appendChild(a)}}}(t,e)}};const M=w;var D=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vue-zoomer",style:{backgroundColor:t.backgroundColor},on:{mousewheel:function(e){return e.preventDefault(),t.onMouseWheel(e)},DOMMouseScroll:t.onMouseWheel,mousedown:t.onMouseDown,mouseup:t.onMouseUp,mousemove:t.onMouseMove,mouseout:t.setPointerPosCenter,touchstart:t.onTouchStart,touchend:t.onTouchEnd,touchmove:t.onTouchMove}},[i("div",{staticClass:"zoomer",style:t.wrapperStyle},[t._t("default")],2)])};D._withStripped=!0;var x=X({render:D,staticRenderFns:[]},(function(t){t&&t("data-v-3cd05a06_0",{source:".vue-zoomer[data-v-3cd05a06] {\n  overflow: hidden;\n  transition: background-color 0.5s;\n}\n.zoomer[data-v-3cd05a06] {\n  transform-origin: 50% 50%;\n  width: 100%;\n  height: 100%;\n}\n.zoomer > img[data-v-3cd05a06] {\n  vertical-align: top;\n  user-drag: none;\n  -webkit-user-drag: none;\n  -moz-user-drag: none;\n}\n",map:void 0,media:void 0})}),M,"data-v-3cd05a06",!1,void 0,S,void 0);const Y={props:{value:{type:Number,required:!0},list:{type:Array,required:!0},backgroundColor:{type:String,default:"#333"},pivot:{type:String,default:"cursor"},limitTranslation:{type:Boolean,default:!0},doubleClickToZoom:{type:Boolean,default:!0}},data(){return{containerWidth:1,containerHeight:1,selIndex:this.value,animSelIndex:this.value,currentZoomed:!1,autoSliding:!1,imageAspectRatios:[],isPointerDown:!1,lastPointerX:0,slideOffsetX:0}},computed:{middleStyle(){return{left:`${0+this.slideOffsetX}px`}},leftStyle(){return{left:`${-this.containerWidth+this.slideOffsetX}px`}},rightStyle(){return{left:`${this.containerWidth+this.slideOffsetX}px`}},slideThresh(){return Math.max(50,.1*this.containerWidth)}},watch:{value(t){t!==this.animSelIndex&&(this.selIndex=t,this.animSelIndex=t)},selIndex(){this.$nextTick(()=>{this.$refs.zoomers.forEach(t=>{t.refreshContainerPos()})})}},mounted(){window.addEventListener("resize",this.onWindowResize),this.onWindowResize()},destroyed(){window.removeEventListener("resize",this.onWindowResize)},methods:{reset(){this.$refs.zoomers.forEach(t=>{t.reset()})},zoomIn(t){this.$refs.zoomers[1]&&this.$refs.zoomers[1].zoomIn(t)},zoomOut(t){this.$refs.zoomers[1]&&this.$refs.zoomers[1].zoomOut(t)},onWindowResize(){let t=window.getComputedStyle(this.$el);this.containerWidth=parseFloat(t.width),this.containerHeight=parseFloat(t.height)},onPointerMove(t){if(this.isPointerDown&&!this.currentZoomed){let e=0===this.selIndex&&t>0&&this.slideOffsetX+t>0||this.selIndex===this.list.length-1&&t<0&&this.slideOffsetX+t<0?.3:1;this.slideOffsetX+=t*e}},onPointerUp(){this.slideOffsetX<-this.slideThresh?this.paginate(1):this.slideOffsetX>this.slideThresh?this.paginate(-1):this.paginate(0)},onImageDragStart:t=>(t.preventDefault(),!1),paginate(t){let e=this.selIndex+t;e<0||e>=this.list.length?this.slideOffsetX=0:(this.slideOffsetX=this.containerWidth*-t,this.autoSliding=!0,this.$emit("input",e),this.animSelIndex=e,setTimeout(()=>{this.selIndex=e,this.slideOffsetX=0,this.autoSliding=!1},400))},onMouseDown(t){this.isPointerDown=!0,this.lastPointerX=t.clientX},onMouseUp(t){this.isPointerDown=!1,this.onPointerUp()},onMouseMove(t){this.isPointerDown&&(this.onPointerMove(t.clientX-this.lastPointerX),this.lastPointerX=t.clientX)},onTouchStart(t){1===t.touches.length&&(this.isPointerDown=!0,this.lastPointerX=t.touches[0].clientX)},onTouchEnd(t){0===t.touches.length&&(this.isPointerDown=!1,this.onPointerUp())},onTouchMove(t){1===t.touches.length&&(this.onPointerMove(t.touches[0].clientX-this.lastPointerX),this.lastPointerX=t.touches[0].clientX)},onImageLoad(t,e){let i=e.target.naturalWidth/e.target.naturalHeight;this.$set(this.imageAspectRatios,t,i)},onImageSwipe(t){this.paginate("right"==t?-1:1)}}};var z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vue-zoomer-gallery",class:{anim:t.autoSliding&&!t.isPointerDown},style:{"background-color":t.backgroundColor},on:{mousemove:t.onMouseMove,mousedown:t.onMouseDown,mouseout:t.onMouseUp,mouseup:t.onMouseUp,touchstart:t.onTouchStart,touchend:t.onTouchEnd,touchmove:function(e){return e.preventDefault(),t.onTouchMove(e)}}},t._l(3,(function(e,n){return i("v-zoomer",{key:n+t.selIndex,ref:"zoomers",refInFor:!0,staticClass:"slide",class:["left","middle","right"][n],style:[t.leftStyle,t.middleStyle,t.rightStyle][n],attrs:{"max-scale":10,zoomed:t.currentZoomed,"reset-trigger":n,"aspect-ratio":t.imageAspectRatios[t.selIndex+n-1]||1,pivot:t.pivot,"limit-translation":t.limitTranslation,"double-click-to-zoom":t.doubleClickToZoom},on:{"update:zoomed":function(e){t.currentZoomed=e},swipe:t.onImageSwipe}},[t.selIndex+n-1>-1&&t.selIndex+n-1<t.list.length?i("img",{staticStyle:{"object-fit":"contain",width:"100%",height:"100%"},attrs:{src:t.list[t.selIndex+n-1],draggable:"false"},on:{load:function(e){return t.onImageLoad(t.selIndex+n-1,e)},dragstart:t.onImageDragStart}}):t._e()])})),1)};z._withStripped=!0;var E=X({render:z,staticRenderFns:[]},(function(t){t&&t("data-v-8a416128_0",{source:".vue-zoomer-gallery[data-v-8a416128] {\n  position: relative;\n  overflow: hidden;\n  user-select: none;\n  min-width: 100px;\n  min-height: 100px;\n}\n.vue-zoomer-gallery > *[data-v-8a416128] {\n  display: inline-block;\n}\n.vue-zoomer-gallery.anim .slide[data-v-8a416128] {\n  transition: left 0.4s;\n}\n.slide[data-v-8a416128] {\n  position: absolute;\n  top: 0;\n  object-fit: contain;\n  width: 100%;\n  height: 100%;\n  user-drag: none;\n  -webkit-user-drag: none;\n  -moz-user-drag: none;\n  -ms-user-drag: none;\n}\n",map:void 0,media:void 0})}),Y,"data-v-8a416128",!1,void 0,S,void 0);return{install(t){t.component("VZoomer",x),t.component("VZoomerGallery",E)}}}));
